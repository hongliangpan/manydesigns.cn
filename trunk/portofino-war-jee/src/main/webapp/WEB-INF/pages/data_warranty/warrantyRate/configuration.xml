<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<configuration database="riil_its_board" legend="state" name="维保率分析" orientation="VERTICAL" query="SELECT t_begin.c_region3,t_begin.c_region3, t_end.c_count/t_begin.c_count c_value FROM&#xD;&#xA;(&#xD;&#xA;SELECT c_region3, count(0) c_count FROM&#xD;&#xA;(SELECT c_region3,c_customer_id,MIN(w.c_warranty_end),is_expired(MIN(w.c_warranty_end)) c_is_expired FROM t_customer_warranty w&#xD;&#xA;INNER JOIN t_customer c ON c.c_id =w.c_customer_id&#xD;&#xA;WHERE YEAR(w.c_warranty_end)=YEAR(DATE_SUB(NOW(),INTERVAL 30 day)) AND 1=1&#xD;&#xA;GROUP BY c_region3,c_customer_id&#xD;&#xA;HAVING is_expired(MIN(w.c_warranty_end))=1&#xD;&#xA;) t1 GROUP BY c_region3&#xD;&#xA;) t_begin&#xD;&#xA;LEFT JOIN&#xD;&#xA;(&#xD;&#xA;SELECT c_region3, count(0) c_count FROM&#xD;&#xA;(&#xD;&#xA;SELECT c_region3,c_customer_id,MAX(w.c_warranty_end),is_expired(MAX(w.c_warranty_end)) c_is_expired FROM t_customer_warranty w&#xD;&#xA;INNER JOIN t_customer c ON c.c_id =w.c_customer_id&#xD;&#xA;WHERE YEAR(w.c_warranty_end)&gt;=YEAR(DATE_SUB(NOW(),INTERVAL 30 day)) AND 1=1&#xD;&#xA;GROUP BY c_region3,c_customer_id&#xD;&#xA;HAVING is_expired(MAX(w.c_warranty_end))=1&#xD;&#xA;) t2 GROUP BY c_region3&#xD;&#xA;) t_end ON t_begin.c_region3=t_end.c_region3" type="BAR3D" urlExpression=""/>
